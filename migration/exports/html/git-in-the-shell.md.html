<p><img src="https://blog.replit.com/images/git-in-the-shell/ghost-in.mp4" alt="Ghost in the Shell robot typing with multiply bifurcating fingers"></p>
<p>Starting today, the Git command-line tools of all Repls provide a much better experience and integrate with your GitHub account. If you connect your GitHub account to Replit from the <a href="https://replit.com/account">Account page</a>, your Git commands (like <code>git clone</code>, <code>git fetch</code>, <code>git push</code>) will have access to your GitHub repositories: </p>
<p><img src="https://blog.replit.com/images/git-in-the-shell/clone.mp4" alt="cloning a git repository from github via the shell"></p>
<p>You&#39;re now able compose Git commit messages in the editor:</p>
<p><img src="https://blog.replit.com/images/git-in-the-shell/commitpush.mp4" alt="editing a git commit message then pushing to GitHub"></p>
<p>Or, even do interactive rebases:</p>
<p><img src="https://blog.replit.com/images/git-in-the-shell/rebase.png" alt="editing an interactive rebase plan"></p>
<p>For security, the first time each session that Git needs your GitHub token, you&#39;ll see this message:</p>
<p><img src="https://blog.replit.com/images/git-in-the-shell/dialog.png" alt="dialog asking to pass GitHub credentials to the shell"></p>
<p>Then subsequent requests will run seamlessly.</p>
<p>Please note, this feature is not designed for Multiplayer, and we do not recommend you use it with Multiplayer because the other people could access your GitHub token.</p>
<p>Please let us know what you think of Git in the Shell on the <a href="https://ask.replit.com/t/announcing-git-in-the-shell/8167">Replit Ask forum</a> and read on if you are interested in how we built it.</p>
<h2>How we built it</h2>
<p>Let&#39;s start by explaining how the Git editor integration works. In the backend, we&#39;ve set the <code>GIT_EDITOR</code> environment variable for you, so that when you run a Git command that needs an editor it knows to use the Workspace editor. To make this work, we&#39;ve added a new REST API to each Repl that allows it to communicate with the Workspace. For example,</p>
<pre><code class="language-bash">curl -X POST &quot;localhost:8283/files/open&quot; \
  -H &quot;Accept: application/json&quot; -H &quot;Content-Type: application/json&quot; \
  --data &#39;{&quot;filename&quot;: &quot;.replit&quot;}&#39;
</code></pre>
<p>will open the <code>.replit</code> file.</p>
<p>For commit messages to work, we needed the API to wait until the file is closed. For example,</p>
<pre><code class="language-bash">curl -X POST &quot;localhost:8283/files/open&quot; \
  -H &quot;Accept: application/json&quot; -H &quot;Content-Type: application/json&quot; \
  --data &#39;{&quot;filename&quot;: &quot;.replit&quot;, &quot;waitForClose&quot;: true}&#39;
</code></pre>
<p>will open the <code>.replit</code> file and not return until the tab is closed.</p>
<p>The other piece of the puzzle is authentication. Git checks for the environment variable <code>GIT_ASKPASS</code>, which has an <em>interesting</em> interface.</p>
<p>Say Git wants to get a username for remote at <a href="https://github.com">https://github.com</a>. It sends the same string to the <code>GIT_ASKPASS</code> script that it would normally send to a user on the command-line. In this case</p>
<pre><code class="language-txt">Username for &#39;https://github.com&#39;: 
</code></pre>
<p>And it expects the standard output of <code>GIT_ASKPASS</code> to be the username, or a non-zero exit code if <code>GIT_ASKPASS</code> doesn&#39;t know the username to use. For GitHub, we can respond with &quot;token&quot; for the username if we have a GitHub token to use.</p>
<p>Then, it calls <code>GIT_ASKPASS</code> again for the password, like:</p>
<pre><code class="language-txt">Password for &#39;https://token@github.com&#39;: 
</code></pre>
<p>and we can respond with the GitHub Token.</p>
<p>The REST API also provides an endpoint for the GitHub API token, which <code>GIT_ASKPASS</code> uses:</p>
<pre><code class="language-bash">curl &quot;localhost:8283/github/token&quot;
</code></pre>
<p>By interfacing with these standard Git environment variables, we&#39;ve been able to make the Git command line experience a lot better on Replit.</p>
<p>Are you interested in programing, operating systems, and other open-source technologies? <a href="https://replit.com/site/careers">Come work with us!</a></p>
