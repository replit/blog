<p>For the past year we have been working hard to integrate <a href="https://nixos.org/">Nix</a> into our platform and rebuild our existing language experiences with package from Nix. We are excited to announce that all new repls are now powered by Nix. In this post we&#39;ll talk about what this means for the future of the platform and all the work that it took to get here.</p>
<p>With Nix you can easily create templates for languages Replit didn&#39;t support before, pull in more development tools than ever, and access any cli application in the shell without installing anything:</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/HC_2YEWZrAc" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>Every new repl being powered by Nix means that we&#39;ve be able to make vast improvements to our existing languages:</p>
<ul>
<li>Long awaited Node.js v16 support</li>
<li><a href="https://blog.replit.com/python-new-template">100x faster Python package management</a></li>
<li>Improved code analysis tools for Go, Rust, and many other languages</li>
</ul>
<p>We can also update these versions for new repls without breaking pre-existing repls. Additionally, you can now peek into the internal repl configuration: add Linux packages, customize the run command, configure a new language server, etc...</p>
<p>When we initially <a href="https://blog.replit.com/nix">announced Nix</a>, we added a new kind of repl: the &quot;Nix repl&quot;. You could choose this repl to get a blank slate and install/configure the repl however you liked. However, at that time, most other repls were still based on our legacy solution, <a href="https://github.com/replit/polygott">Polygott</a>. This created a divide, Nix repls and non-Nix repls. We&#39;ve now closed this gap and all new repls are powered with Nix and <a href="https://docs.replit.com/programming-ide/configuring-repl"><code>.replit</code></a>.</p>
<h2>How did we get here?</h2>
<p>To rebuild the existing Replit language configurations on top of Nix, we had to build and expose some new tooling to allow for advanced customization and publishable templates. The driving mindset was: Which configuration knobs do we need to expose such that a user never has to ask a Replit employee to change some internal configuration? It turns out, we had to expose a <em>lot</em> of configuration knobs.</p>
<h3>1: <a href="https://blog.replit.com/nix">Nix Package Manager</a></h3>
<p>The initial step in the process was allowing users to install arbitrary linux packages. We selected Nix for this as it&#39;s caching and store system allow for near-instant package installation times. We&#39;ve written a lot about Nix on the blog; check out some of our other posts if you want to dive in deeper:</p>
<ul>
<li><a href="https://blog.replit.com/nix">Initial Replit + Nix announcement</a></li>
<li><a href="https://blog.replit.com/betting-on-nix">Betting on Nix</a></li>
<li><a href="https://blog.replit.com/nix-perf-improvements">Faster Nix Repl Startup</a></li>
<li><a href="https://blog.replit.com/nix-vs-docker">Will Nix Overtake Docker?</a></li>
</ul>
<h3>2: <a href="https://blog.replit.com/replspace-templates#how-do-i-configure-a-template"><code>.replit</code></a></h3>
<p>Just adding Nix support to the platform is not enough. Replit supports many features like code intelligence via the <a href="https://microsoft.github.io/language-server-protocol/">Language Server Protocol</a>, automatical package management through the <a href="https://github.com/replit/upm">Universal Package Manager</a>, and an integrated REPL experience through <a href="https://github.com/replit/prybar">Prybar</a>.</p>
<p>All of these features were maintained in our code base in JSON configuration files. If anything needed to be tweaked, you had to ask a Replit employee.</p>
<p>It became clear that we needed to expand the existing <code>.replit</code> configuration file to support dynamic configuration of these features.</p>
<p>Since then we&#39;ve added a ton of new configuration options for all core Replit workspace features:</p>
<ul>
<li>Integrated REPL/Interpreter</li>
<li>Code intelligence</li>
<li>Package management</li>
<li>Debugger</li>
</ul>
<p>To learn more about how to configure a repl, check out our <a href="https://docs.replit.com/programming-ide/configuring-repl">docs</a>.</p>
<h3>3: <a href="https://blog.replit.com/replspace-templates">Templates</a></h3>
<p>So far we could pull in packages that we need from Nix, like <code>node</code> and <code>typescript-language-server</code>. We could even hook up the run button to execute <code>node index.js</code> and hook up code intelligence to use <code>typescript-language-server</code>. But, we didn&#39;t have a good way to showcase these templates. We needed a way to add these templates to the Create Repl modal and a place to showcase all the available templates on the platform.</p>
<p>To fix this, we built a template publishing flow so we can build and publish templates entirely in replspace. Templates also have a release mechanism so that any changes made to the template don&#39;t show up in new repls until the template publishes a new release. In the future, users of templates will be able to pull in updates from the latest template release.</p>
<p>To track our progress of converting all our supported languages to the new Nix and templates infrastructure, we created a website hosted in a repl: <a href="https://arewenixyet.com">https://arewenixyet.com</a>. This allowed for people within the company and within the community to follow along and help out with the process.</p>
<p>Read more about templates and replspace <a href="https://blog.replit.com/replspace-templates">here</a>.</p>
<h3>All together now</h3>
<p>Combining all these together, we now have an extensible platform where users can create a new templates for other users to consume. This means the platform is no longer limited by the Replit team as community members can manage templates for popular languages and configurations.</p>
<h2>Future Plans</h2>
<p>While all new repls are powered with Nix, old repls may still be powered by <a href="https://github.com/replit/polygott">Polygott</a>. Eventually, we will be phasing out Polygott and automatically migrating old repls to be backed by Nix. We will share more details about the migration timeline in the future and provide a way to manually migrate your repls to Nix.</p>
<p>If building the most powerful development environment on the web sounds like your kind of challenge, <a href="https://replit.com/site/careers">we&#39;re hiring</a>. We&#39;d love to hear from you!</p>
