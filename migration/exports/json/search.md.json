{"_id":"post-bf481277-a186-4966-be4f-b2aa51a768eb","_type":"post","title":"We Built a Search Engine","slug":{"_type":"slug","current":"search"},"body":[{"_key":"9c4b71ebc6fd","children":[{"_type":"span","marks":[],"text":"For the past few months, we have been building a Replit-native search engine. It is remarkably powerful, and we are really excited for you all to try it out. ","_key":"9c4b71ebc6fd0"},{"_type":"span","marks":["strong"],"text":"We believe that you should be able to find anything on Replit in less than 30 seconds.","_key":"9c4b71ebc6fd1"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"358b94eb4425","children":[{"_type":"span","marks":[],"text":"This might sound simple, but when you have 100 million+ Repls, it becomes complicated. :)","_key":"358b94eb44250"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"7c8da83e63e6","children":[{"_type":"span","marks":[],"text":"When you search for something on Replit today, you'll see a page with relevant results from the following categories:","_key":"7c8da83e63e60"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"46e43a6c8b03","children":[{"_type":"span","marks":[],"text":"Repls","_key":"46e43a6c8b030"}],"markDefs":[],"_type":"block","style":"normal","level":1,"listItem":"bullet"},{"_key":"5ea73fe02b57","children":[{"_type":"span","marks":[],"text":"Templates","_key":"5ea73fe02b570"}],"markDefs":[],"_type":"block","style":"normal","level":1,"listItem":"bullet"},{"_key":"19ac37afd204","children":[{"_type":"span","marks":[],"text":"Code (yes, code)","_key":"19ac37afd2040"}],"markDefs":[],"_type":"block","style":"normal","level":1,"listItem":"bullet"},{"_key":"adab9622c94a","children":[{"_type":"span","marks":[],"text":"Users","_key":"adab9622c94a0"}],"markDefs":[],"_type":"block","style":"normal","level":1,"listItem":"bullet"},{"_key":"13e0edc2ae19","children":[{"_type":"span","marks":[],"text":"Community content (published repls, posts)","_key":"13e0edc2ae190"}],"markDefs":[],"_type":"block","style":"normal","level":1,"listItem":"bullet"},{"_key":"1107d7e2dfae","children":[{"_type":"span","marks":[],"text":"Our docs","_key":"1107d7e2dfae0"}],"markDefs":[],"_type":"block","style":"normal","level":1,"listItem":"bullet"},{"_key":"4ad4ecc7708a","children":[{"_type":"span","marks":[],"text":"Community tags","_key":"4ad4ecc7708a0"}],"markDefs":[],"_type":"block","style":"normal","level":1,"listItem":"bullet"},{"_key":"fbcd235f821d","children":[{"_type":"span","marks":[],"text":"Why we built it","_key":"fbcd235f821d0"}],"markDefs":[],"_type":"block","style":"h3"},{"_key":"abe346c70a81","children":[{"_type":"span","marks":[],"text":"We think that being able to search for stuff is important. Searching can help you find inspiration, discover other users, and even learn how to code.","_key":"abe346c70a810"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"e87d82b23d90","children":[{"_type":"span","marks":[],"text":"Prior to this update, there was no effective way for users to find anything on Replit. You could only search through the names of Repls that you owned. Even then, you had to type the exact string match to get any results.","_key":"e87d82b23d900"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"caa1fd83dd4e","children":[{"_type":"span","marks":[],"text":"We have known for a while that the search experience needed to be updated, but for much of last year we focused on more critical projects. (Workspace stability, abuse, etc.)","_key":"caa1fd83dd4e0"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"6b698628a2f5","children":[{"_type":"span","marks":[],"text":"Aside from our team's general dissatisfaction, there were a few other signals that prompted us to fix the search experience:","_key":"6b698628a2f50"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"7d101a8ace28","children":[{"_type":"span","marks":[],"text":"qualitatively, people complained about the lack of functionality in surveys and interviews.","_key":"7d101a8ace280"}],"markDefs":[],"_type":"block","style":"normal","level":1,"listItem":"number"},{"_key":"d4ebf0459f7b","children":[{"_type":"span","marks":[],"text":"quantitatively, 80%~ of users that navigated to search ended up dropping off entirely. They weren't able to find what they were looking for. Retention for this feature was also significantly lower than other features.","_key":"d4ebf0459f7b0"}],"markDefs":[],"_type":"block","style":"normal","level":1,"listItem":"number"},{"_key":"b5d01e924b99","children":[{"_type":"span","marks":[],"text":"In building this, we hope to give everyone tools for the self-led discovery of all different types of content on Replit.","_key":"b5d01e924b990"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"1adf1e8a9e62","children":[{"_type":"span","marks":[],"text":"How we built it","_key":"1adf1e8a9e620"}],"markDefs":[],"_type":"block","style":"h3"},{"_key":"3c17e4bf9903","children":[{"_type":"span","marks":[],"text":"A search engine has a few different components:","_key":"3c17e4bf99030"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"3e3c00824953","children":[{"_type":"span","marks":[],"text":"A web frontend where users type their queries and see results","_key":"3e3c008249530"}],"markDefs":[],"_type":"block","style":"normal","level":1,"listItem":"bullet"},{"_key":"4910cb7b0b3e","children":[{"_type":"span","marks":[],"text":"A server backend that receives requests from the frontend and serves responses","_key":"4910cb7b0b3e0"}],"markDefs":[],"_type":"block","style":"normal","level":1,"listItem":"bullet"},{"_key":"98838675771e","children":[{"_type":"span","marks":[],"text":"The actual search engine that indexes documents and executes search queries","_key":"98838675771e0"}],"markDefs":[],"_type":"block","style":"normal","level":1,"listItem":"bullet"},{"_key":"cc33f1485c10","children":[{"_type":"span","marks":[],"text":"Data pipelines for creating and updating search indexes","_key":"cc33f1485c100"}],"markDefs":[],"_type":"block","style":"normal","level":1,"listItem":"bullet"},{"_key":"89e09038e327","children":[{"_type":"span","marks":[],"text":"The first two were relatively straightforward. We built the search page like we build every other page on Replit: in Typescript, with a Next.js (React) frontend and an Express backend, with GraphQL as the API layer in between.","_key":"89e09038e3270"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"1a6ef18de785","children":[{"_type":"span","marks":[],"text":"The other components were a little more complicated, since we haven't done anything like this at scale before.","_key":"1a6ef18de7850"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"3265bf701c7a","children":[{"_type":"span","marks":[],"text":"A few other small search features on the site such as the community search box were built with ","_key":"3265bf701c7a0"},{"_type":"span","marks":["e172ea5c0580"],"text":"the Sphinx library","_key":"3265bf701c7a1"},{"_type":"span","marks":[],"text":". This was simple to set up at the time with some custom infrastructure to support indexing and executing queries. However, this setup hasn't aged well, and we weren't comfortable expanding it to vastly larger datasets.","_key":"3265bf701c7a2"}],"markDefs":[{"_key":"e172ea5c0580","_type":"link","href":"http://sphinxsearch.com/"}],"_type":"block","style":"normal"},{"_key":"ee7ccda3f6e0","children":[{"_type":"span","marks":[],"text":"After looking through our options, we settled on Elasticsearch because of its stability, supporting libraries for big data ingestion, and the large community that has battle-tested it in production setups over the years.","_key":"ee7ccda3f6e00"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"3e86c796ad24","children":[{"_type":"span","marks":[],"text":"For the data pipelines we use Apache Spark. These are high-throughput jobs that run on clusters of many machines at once. The details of how these jobs work is worth a post on its own, but broadly speaking they take data from other locations (the BigQuery data warehouse, Google Cloud Storage, etc), process them into search documents, and bulk upload to the Elasticsearch cluster.","_key":"3e86c796ad240"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"b3ffec5e8a7f","children":[{"_type":"span","marks":[],"text":"We're working on scaling these big data jobs even further. For example, our code search supports searching through the contents of published repls. In the future, we'll expand this to every file in every repl. You'll be able to find even more working code results and sample code to learn from.","_key":"b3ffec5e8a7f0"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"9e97589d0804","children":[{"_type":"span","marks":[],"text":"What's next?","_key":"9e97589d08040"}],"markDefs":[],"_type":"block","style":"h3"},{"_key":"09bf8911e6a0","children":[{"_type":"span","marks":[],"text":"On March 31st, we released search to 100% of users.","_key":"09bf8911e6a00"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"e39fdc7c0ef6","children":[{"_type":"span","marks":[],"text":"If you helped with any early prototypes, participated in any user interviews, or were a part of the explorer beta, we want to say thank you! We could not have made it this far without your help.","_key":"e39fdc7c0ef60"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"612d7ace08da","children":[{"_type":"span","marks":[],"text":"If you'd like to leave feedback on the new search experience, please leave a comment on ","_key":"612d7ace08da0"},{"_type":"span","marks":["1a67278dbe67"],"text":"this","_key":"612d7ace08da1"},{"_type":"span","marks":[],"text":" Repl. We're open to any and all types of feedback.","_key":"612d7ace08da2"}],"markDefs":[{"_key":"1a67278dbe67","_type":"link","href":"https://replit.com/@util/Search-20-Feedback?c=212850"}],"_type":"block","style":"normal"},{"_key":"211459365dcf","children":[{"_type":"span","marks":[],"text":"If this project seems interesting to you, consider checking out our ","_key":"211459365dcf0"},{"_type":"span","marks":["a50033e954f7"],"text":"careers","_key":"211459365dcf1"},{"_type":"span","marks":[],"text":" page. :)","_key":"211459365dcf2"}],"markDefs":[{"_key":"a50033e954f7","_type":"link","href":"https://replit.com/site/careers"}],"_type":"block","style":"normal"}],"publishedAt":"2022-03-31T00:00:00.000Z"}