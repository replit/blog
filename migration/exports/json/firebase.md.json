{"_id":"post-f8fa52a3-c9e1-4e24-a818-7fb18c78d349","_type":"post","title":"How to use Firebase for a website with Replit","slug":{"_type":"slug","current":"firebase"},"body":[{"_key":"da2c4bff51b4","children":[{"_type":"span","marks":[],"text":"Today we're going to learn how to use Firebase as a database for a simple website using JavaScript!","_key":"da2c4bff51b40"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"aafaa5b84429","children":[{"_type":"span","marks":[],"text":"Right now, this is what my fantastic website looks like","_key":"aafaa5b844290"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"a4c3ed5e062b","children":[{"_type":"span","_key":"a4c3ed5e062b0","text":"","marks":[]}],"markDefs":[],"_type":"block","style":"blockquote"},{"_key":"482b3a1cf01f","children":[{"_type":"span","marks":[],"text":"What I want to do is include a guestbook, a way for people who visit the site to leave a wonderful message for those who follow in their steps. So, in the end, I should have a website that looks something like this.","_key":"482b3a1cf01f0"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"25275f5831d0","children":[{"_type":"span","_key":"25275f5831d00","text":"","marks":[]}],"markDefs":[],"_type":"block","style":"blockquote"},{"_key":"d9cb3afe4ea8","children":[{"_type":"span","marks":[],"text":"I don't have any CSS in my website but that's only so the implemented feature is blatantly obvious.","_key":"d9cb3afe4ea80"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"f7fa83d443d2","children":[{"_type":"span","marks":[],"text":"The first thing you'll need for this is a website and a url you can access it with. I'll be using my fantastic website which you can fork ","_key":"f7fa83d443d20"},{"_type":"span","marks":["c1d237ea2d5a"],"text":"here","_key":"f7fa83d443d21"},{"_type":"span","marks":[],"text":". Once you have those two things, continue along to the following steps!","_key":"f7fa83d443d22"}],"markDefs":[{"_key":"c1d237ea2d5a","_type":"link","href":"https://repl.it/@yevbar/My-Fantastic-Website"}],"_type":"block","style":"normal"},{"_key":"783541cd1f1d","children":[{"_type":"span","marks":[],"text":"We need to first set up Firebase before we can use it in our website so let's go and do that. If you're interested in learning a bit more about Firebase, check out their website at ","_key":"783541cd1f1d0"},{"_type":"span","marks":["03a423dc7182"],"text":"firebase.google.com","_key":"783541cd1f1d1"},{"_type":"span","marks":[],"text":".","_key":"783541cd1f1d2"}],"markDefs":[{"_key":"03a423dc7182","_type":"link","href":"https://firebase.google.com/"}],"_type":"block","style":"normal"},{"_key":"711baf064cdf","children":[{"_type":"span","marks":[],"text":"Once you're ready, go over to ","_key":"711baf064cdf0"},{"_type":"span","marks":["123bdb40bc1b"],"text":"console.firebase.google.com","_key":"711baf064cdf1"},{"_type":"span","marks":[],"text":". If you're not already logged into a Google account, it'll prompt you to do so.","_key":"711baf064cdf2"}],"markDefs":[{"_key":"123bdb40bc1b","_type":"link","href":"https://console.firebase.google.com/"}],"_type":"block","style":"normal"},{"_key":"fdea74aea9ca","children":[{"_type":"span","marks":[],"text":"As soon as you're logged in, you'll be greeted with your Firebase Console","_key":"fdea74aea9ca0"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"27e5c5887963","children":[{"_type":"span","_key":"27e5c58879630","text":"","marks":[]}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"c00b878a94e4","children":[{"_type":"span","marks":[],"text":"Go ahead and \"Add Project\" then put whatever you like for the name of your application","_key":"c00b878a94e40"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"f60392034bbb","children":[{"_type":"span","_key":"f60392034bbb0","text":"","marks":[]}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"f9f3017ecff8","children":[{"_type":"span","marks":[],"text":"Select \"Create Project\" and after a few seconds you'll see the dashboard for the app you just created","_key":"f9f3017ecff80"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"7b280a83aeef","children":[{"_type":"span","_key":"7b280a83aeef0","text":"","marks":[]}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"562c60e83e36","children":[{"_type":"span","marks":[],"text":"At this point, we have an application but it's not fully configured yet so let's change that. Under ","_key":"562c60e83e360"},{"_type":"span","marks":["strong"],"text":"Develop","_key":"562c60e83e361"},{"_type":"span","marks":[],"text":", select ","_key":"562c60e83e362"},{"_type":"span","marks":["strong"],"text":"Authentication","_key":"562c60e83e363"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"c99fcad3ac0b","children":[{"_type":"span","_key":"c99fcad3ac0b0","text":"","marks":[]}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"8940ec6d8609","children":[{"_type":"span","marks":[],"text":"Next, go to the ","_key":"8940ec6d86090"},{"_type":"span","marks":["strong"],"text":"Sign-In method","_key":"8940ec6d86091"},{"_type":"span","marks":[],"text":" tab","_key":"8940ec6d86092"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"c6eb1b132748","children":[{"_type":"span","_key":"c6eb1b1327480","text":"","marks":[]}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"684467919332","children":[{"_type":"span","marks":[],"text":"Scroll down to the section with ","_key":"6844679193320"},{"_type":"span","marks":["strong"],"text":"Authorized domains","_key":"6844679193321"},{"_type":"span","marks":[],"text":" and add the url for the hosted repl","_key":"6844679193322"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"4f448f6612eb","children":[{"_type":"span","_key":"4f448f6612eb0","text":"","marks":[]}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"60a9b522d250","children":[{"_type":"span","marks":[],"text":"The last thing we need to do to configure our database is actually set the permissions for an app to access/write our database. To do that, go over to ","_key":"60a9b522d2500"},{"_type":"span","marks":["strong"],"text":"Database","_key":"60a9b522d2501"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"2352c174bf07","children":[{"_type":"span","_key":"2352c174bf070","text":"","marks":[]}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"ea0d34f45898","children":[{"_type":"span","marks":[],"text":"Scroll down to ","_key":"ea0d34f458980"},{"_type":"span","marks":["strong"],"text":"Realtime Database","_key":"ea0d34f458981"},{"_type":"span","marks":[],"text":" and \"Create database\"","_key":"ea0d34f458982"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"9de84519ddf4","children":[{"_type":"span","_key":"9de84519ddf40","text":"","marks":[]}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"3360ce871dd7","children":[{"_type":"span","marks":[],"text":"It doesn't really matter what rules you initialize with since we'll be setting those next. As soon as you create your database, you'll see a dashboard for that database. Click on \"Rules\" and, if needed, modify the JSON so that it's the following","_key":"3360ce871dd70"}],"markDefs":[],"_type":"block","style":"normal"},{"_type":"codeBlock","language":"text","codeContent":"{\n  \"rules\": {\n    \".read\": true,\n    \".write\": true\n  }\n}\n","_key":"d90afcb2fc29"},{"_key":"f22aae70a997","children":[{"_type":"span","marks":[],"text":"What this means is that any user or app that is under the authorized domains can both read and modify our database. In my case with reviews on my website, I don't really mind, however, if you're making a website or project where security of information is important then do manage permissions accordingly. If you're looking to access the database from a server or such, check out how to ","_key":"f22aae70a9970"},{"_type":"span","marks":["86727bfa22bf"],"text":"add the Firebase Admin SDK to your server","_key":"f22aae70a9971"},{"_type":"span","marks":[],"text":" so that you can properly configure the rules for your app.","_key":"f22aae70a9972"}],"markDefs":[{"_key":"86727bfa22bf","_type":"link","href":"https://firebase.google.com/docs/admin/setup"}],"_type":"block","style":"normal"},{"_key":"93e3b0606b23","children":[{"_type":"span","marks":[],"text":"With that, we're ready to start using Firebase!","_key":"93e3b0606b230"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"047e3a96dee9","children":[{"_type":"span","marks":[],"text":"The first thing we'll need to put in our website are some dependencies. I'll be using JQuery to dynamically add comments as well as two Firebase libraries where one's to connect to Firebase and the other is to utilize the realtime database. Be sure to put these before any of your ","_key":"047e3a96dee90"},{"_type":"span","marks":["code"],"text":"<script>","_key":"047e3a96dee91"},{"_type":"span","marks":[],"text":" elements","_key":"047e3a96dee92"}],"markDefs":[],"_type":"block","style":"normal"},{"_type":"codeBlock","language":"text","codeContent":"<script src=\"https://code.jquery.com/jquery-3.3.1.min.js\"></script>\n<script src=\"https://www.gstatic.com/firebasejs/5.3.0/firebase-app.js\"></script>\n<script src=\"https://www.gstatic.com/firebasejs/5.3.0/firebase-database.js\"></script>\n","_key":"2060311cc83f"},{"_key":"7452e2a6ab43","children":[{"_type":"span","marks":[],"text":"At the end of my ","_key":"7452e2a6ab430"},{"_type":"span","marks":["code"],"text":"<body>","_key":"7452e2a6ab431"},{"_type":"span","marks":[],"text":" I put a ","_key":"7452e2a6ab432"},{"_type":"span","marks":["code"],"text":"div","_key":"7452e2a6ab433"},{"_type":"span","marks":[],"text":" with the id \"comments\" and this is where my comments will go","_key":"7452e2a6ab434"}],"markDefs":[],"_type":"block","style":"normal"},{"_type":"codeBlock","language":"text","codeContent":"<body>\n  <!-- Some other HTML... -->\n  <div id=\"comments\">\n  </div>\n</body>\n","_key":"9bee3fbb5d15"},{"_key":"3f21e8e08a0c","children":[{"_type":"span","marks":[],"text":"That's it for the HTML, now we can get working in our JavaScript file.","_key":"3f21e8e08a0c0"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"89426ff3831c","children":[{"_type":"span","marks":[],"text":"First, we'll put in our JQuery ","_key":"89426ff3831c0"},{"_type":"span","marks":["code"],"text":"ready","_key":"89426ff3831c1"},{"_type":"span","marks":[],"text":" function so that the code only executes when the browser is ready","_key":"89426ff3831c2"}],"markDefs":[],"_type":"block","style":"normal"},{"_type":"codeBlock","language":"text","codeContent":"$(document).ready(function() {\n   // This is where our code will go\n});\n","_key":"fc2377cd6a2d"},{"_key":"0f1647571d55","children":[{"_type":"span","marks":[],"text":"We've already configured the database but we need to actually initialize a database connection in our JavaScript so go back to the dashboard for your application and select ","_key":"0f1647571d550"},{"_type":"span","marks":["strong"],"text":"Add Firebase to your web app","_key":"0f1647571d551"},{"_type":"span","marks":[],"text":" so that you're prompted with a code snippet","_key":"0f1647571d552"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"af5a73509d9e","children":[{"_type":"span","_key":"af5a73509d9e0","text":"","marks":[]}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"c6f46e5efd72","children":[{"_type":"span","marks":[],"text":"Copy the JavaScript that's between the ","_key":"c6f46e5efd720"},{"_type":"span","marks":["code"],"text":"script","_key":"c6f46e5efd721"},{"_type":"span","marks":[],"text":" tags and paste it into your ","_key":"c6f46e5efd722"},{"_type":"span","marks":["code"],"text":"ready","_key":"c6f46e5efd723"},{"_type":"span","marks":[],"text":" function so it looks something like this","_key":"c6f46e5efd724"}],"markDefs":[],"_type":"block","style":"normal"},{"_type":"codeBlock","language":"text","codeContent":"$(document).ready(function() {\n  // Initialize Firebase\n  var config = {\n    apiKey: \"AIzaSyDz8OrTtNBOZY2HliZ2-cmsPX8wi-4rGAQ\",\n    authDomain: \"i-love-replit.firebaseapp.com\",\n    databaseURL: \"https://i-love-replit.firebaseio.com\",\n    projectId: \"i-love-replit\",\n    storageBucket: \"i-love-replit.appspot.com\",\n    messagingSenderId: \"214072077152\"\n  };\n  firebase.initializeApp(config);\n});\n","_key":"49917ab8bc83"},{"_key":"94c3cbd024af","children":[{"_type":"span","marks":[],"text":"This just connects to Firebase, we'll want to connect to the Realtime Database and we can do so with the following","_key":"94c3cbd024af0"}],"markDefs":[],"_type":"block","style":"normal"},{"_type":"codeBlock","language":"text","codeContent":"let guestBook = firebase.database().ref();\n","_key":"470ef7bba7ad"},{"_key":"fde70b195321","children":[{"_type":"span","marks":[],"text":"With the ","_key":"fde70b1953210"},{"_type":"span","marks":["code"],"text":"guestBook","_key":"fde70b1953211"},{"_type":"span","marks":[],"text":" object, we can utilize the power of the realtime database (moohoohaha)","_key":"fde70b1953212"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"fbb380391744","children":[{"_type":"span","marks":[],"text":"The first method I'm going to define is a ","_key":"fbb3803917440"},{"_type":"span","marks":["code"],"text":"signGuestbook","_key":"fbb3803917441"},{"_type":"span","marks":[],"text":" method so, whenever I have a name and comment for a review, I can append it on swiftly","_key":"fbb3803917442"}],"markDefs":[],"_type":"block","style":"normal"},{"_type":"codeBlock","language":"text","codeContent":"function signGuestbook(name, comment) {\n  $(\"#comments\").append(\"<p><b>\" + name + \"</b><br/>\" + comment + \"</p>\");\n}\n","_key":"23a0a9c34d83"},{"_key":"38d1e33c69db","children":[{"_type":"span","marks":[],"text":"With that method defined, we're ready to receive objects in the database so let's create a listener for that","_key":"38d1e33c69db0"}],"markDefs":[],"_type":"block","style":"normal"},{"_type":"codeBlock","language":"text","codeContent":"guestBook.on('child_added', function(guest) {\n  // Code goes here\n});\n","_key":"5505c9f517d2"},{"_key":"355dc241c163","children":[{"_type":"span","marks":[],"text":"The way we can access the ","_key":"355dc241c1630"},{"_type":"span","marks":["code"],"text":"guest","_key":"355dc241c1631"},{"_type":"span","marks":[],"text":"'s data is by calling its ","_key":"355dc241c1632"},{"_type":"span","marks":["code"],"text":"val()","_key":"355dc241c1633"},{"_type":"span","marks":[],"text":" function and, using our ","_key":"355dc241c1634"},{"_type":"span","marks":["code"],"text":"signGuestbook","_key":"355dc241c1635"},{"_type":"span","marks":[],"text":" method, we can add reviews as we receive them","_key":"355dc241c1636"}],"markDefs":[],"_type":"block","style":"normal"},{"_type":"codeBlock","language":"text","codeContent":"guestBook.on('child_added', function(guest) {\n  if (guest.val().name && guest.val().comment) {\n      signGuestbook(guest.val().name,guest.val().comment);\n  }\n});\n","_key":"5cd49841cc12"},{"_key":"d26c87991841","children":[{"_type":"span","marks":[],"text":"The reason for checking that the ","_key":"d26c879918410"},{"_type":"span","marks":["code"],"text":"name","_key":"d26c879918411"},{"_type":"span","marks":[],"text":" and ","_key":"d26c879918412"},{"_type":"span","marks":["code"],"text":"comment","_key":"d26c879918413"},{"_type":"span","marks":[],"text":" are truthy is so that our comment appending doesn't break.","_key":"d26c879918414"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"dc7365963677","children":[{"_type":"span","marks":[],"text":"So now that we're ready to receive guests and reviews, let's introduce a way to create them in the first place. To do that, I made a simple HTML form","_key":"dc73659636770"}],"markDefs":[],"_type":"block","style":"normal"},{"_type":"codeBlock","language":"text","codeContent":"<form id=\"guestbook\">\n      <span>Name:</span>\n      <br/>\n      <input type=\"text\" id=\"name\">\n      <br/>\n      <span>Comment:</span>\n      <br/>\n      <input type=\"text\" id=\"comment\">\n      <br/>\n      <button type=\"submit\">Submit</button>\n</form>\n","_key":"0e535f9ae9d6"},{"_key":"6f916823a14b","children":[{"_type":"span","marks":[],"text":"To keep the page from reloading when I \"submit\", I use JQuery","_key":"6f916823a14b0"}],"markDefs":[],"_type":"block","style":"normal"},{"_type":"codeBlock","language":"text","codeContent":"$('#guestbook').submit(function(event) {\n    event.preventDefault();\n});\n","_key":"697a3e1b2a57"},{"_key":"93b9352a0e65","children":[{"_type":"span","marks":[],"text":"When I submit my form, that means I'm adding a review so let's add the given values to our database","_key":"93b9352a0e650"}],"markDefs":[],"_type":"block","style":"normal"},{"_type":"codeBlock","language":"text","codeContent":"$('#guestbook').submit(function(event) {\n  event.preventDefault();\n  // Add guest to guestbook\n  guestBook.push({\n    name: $('#name').val(),\n    comment: $('#comment').val(),\n  });\n});\n","_key":"548cd95fd3ac"},{"_key":"1dc4719e87d5","children":[{"_type":"span","marks":[],"text":"The reason we only add the review to Firebase and not call ","_key":"1dc4719e87d50"},{"_type":"span","marks":["code"],"text":"signGuestbook","_key":"1dc4719e87d51"},{"_type":"span","marks":[],"text":" is because, when we add the review, it triggers the ","_key":"1dc4719e87d52"},{"_type":"span","marks":["code"],"text":"child_added","_key":"1dc4719e87d53"},{"_type":"span","marks":[],"text":" listener so it gets appended from that.","_key":"1dc4719e87d54"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"fd82f3f31f1d","children":[{"_type":"span","marks":[],"text":"For the sake of keeping things clean, I'm going to clear the input elements and reset the focus","_key":"fd82f3f31f1d0"}],"markDefs":[],"_type":"block","style":"normal"},{"_type":"codeBlock","language":"text","codeContent":"$('#guestbook').submit(function(event) {\n  event.preventDefault();\n  // Add guest to guestbook\n  guestBook.push({\n    name: $('#name').val(),\n    comment: $('#comment').val(),\n  });\n\n  $('#name').val('');\n  $('#comment').val('');\n  $('#name').focus();\n});\n","_key":"66319a94286a"},{"_key":"6a6f284e1b11","children":[{"_type":"span","marks":[],"text":"Go ahead and start adding your comments and you'll see your guestbook come to life! If you reload the tab or open in another browser, after a few seconds, you'll see all the previous reviews get appended even though we never made an explicit call to get old data!","_key":"6a6f284e1b110"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"e13f1b1df588","children":[{"_type":"span","marks":[],"text":"The reason for that is, when we initialize our ","_key":"e13f1b1df5880"},{"_type":"span","marks":["code"],"text":"guestBook","_key":"e13f1b1df5881"},{"_type":"span","marks":[],"text":" with the realtime database, it syncs up old data so that it's in the same state as it is on Firebase which makes thing convinient on our end.","_key":"e13f1b1df5882"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"c2b694cba692","children":[{"_type":"span","marks":[],"text":"The last topic to cover is a massive security flaw on our website called XSS. You can learn a lot from the ","_key":"c2b694cba6920"},{"_type":"span","marks":["b97eef9a3591"],"text":"OWASP page","_key":"c2b694cba6921"},{"_type":"span","marks":[],"text":" but it's an attack where user generated code gets executed on another client's app.","_key":"c2b694cba6922"}],"markDefs":[{"_key":"b97eef9a3591","_type":"link","href":"https://www.owasp.org/index.php/XSS"}],"_type":"block","style":"normal"},{"_key":"de49dc7da06b","children":[{"_type":"span","marks":[],"text":"As an example for something you can do right now, put the following as either a name or comment","_key":"de49dc7da06b0"}],"markDefs":[],"_type":"block","style":"normal"},{"_type":"codeBlock","language":"text","codeContent":"<script>alert(1);</script>\n","_key":"f72588f2f078"},{"_key":"7f434c047849","children":[{"_type":"span","marks":[],"text":"What this does is alert the browser which, albeit, is just annoying. However, I can run any javascript here which means I can do a lot more than just annoy you.","_key":"7f434c0478490"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"4071fa06fe38","children":[{"_type":"span","marks":[],"text":"How do we solve this? The only thing we really need to do is HTML escape some characters and we can do that with JQuery","_key":"4071fa06fe380"}],"markDefs":[],"_type":"block","style":"normal"},{"_type":"codeBlock","language":"text","codeContent":"function signGuestbook(name, comment) {\n  const review = document.createElement('p');\n  review.textContent = comment;\n\n  const name = document.createElement('p');\n  const bold = document.createElement('b');\n  bold.textContent = name;\n  name.appendChild(bold);\n\n  document.getElementById('comments').appendChild(name);\n  document.getElementById('comments').appendChild(review);\n}\n","_key":"c5d096fb4a88"},{"_key":"d0b418afc0fd","children":[{"_type":"span","marks":[],"text":"And, with that, you have a functioning guestbook on your website!","_key":"d0b418afc0fd0"}],"markDefs":[],"_type":"block","style":"normal"},{"_key":"f181db92ba90","children":[{"_type":"span","marks":[],"text":"If you have any questions or just want to say hi, feel free to shoot me an email at ","_key":"f181db92ba900"},{"_type":"span","marks":["c19cfb0edb0a"],"text":"yev@repl.it","_key":"f181db92ba901"},{"_type":"span","marks":[],"text":" and till next time!","_key":"f181db92ba902"}],"markDefs":[{"_key":"c19cfb0edb0a","_type":"link","href":"mailto:yev@repl.it"}],"_type":"block","style":"normal"}],"publishedAt":"2018-07-26T00:55:39.000Z"}